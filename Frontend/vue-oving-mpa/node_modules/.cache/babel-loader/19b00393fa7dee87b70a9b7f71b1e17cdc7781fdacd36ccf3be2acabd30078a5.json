{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\nimport { ref } from 'vue';\nimport { useRouter } from 'vue-router';\nimport { authState } from '@/eventBus'; // Ensure correct path to eventBus.js\n\nexport default {\n  __name: 'Login',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const username = ref('');\n    const password = ref('');\n    const router = useRouter();\n    const login = async () => {\n      try {\n        const response = await fetch('http://localhost:8088/api/calculator/login', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/x-www-form-urlencoded'\n          },\n          body: new URLSearchParams({\n            username: username.value,\n            password: password.value\n          })\n        });\n        if (response.ok) {\n          const token = await response.text();\n          console.log('Received token:', token); // Log the token\n          if (!token || !token.includes('.')) {\n            console.error('Token is not a valid JWT:', token);\n          }\n          sessionStorage.setItem('jwtToken', token);\n          authState.isLoggedIn = true; // Set authState\n          router.push('/calculator');\n        } else {\n          console.log('Login failed with status:', response.status, 'Response:', await response.text());\n          alert('Login failed');\n        }\n      } catch (error) {\n        console.error('Login error:', error);\n        alert('An error occurred during login');\n      }\n    };\n    const __returned__ = {\n      username,\n      password,\n      router,\n      login,\n      ref,\n      get useRouter() {\n        return useRouter;\n      },\n      get authState() {\n        return authState;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","useRouter","authState","username","password","router","login","response","fetch","method","headers","body","URLSearchParams","value","ok","token","text","console","log","includes","error","sessionStorage","setItem","isLoggedIn","push","status","alert"],"sources":["C:/Users/sigau/OneDrive - NTNU/Dataingeniør S4/IDATT2105 Full-stack applikasjonsutvikling/Øvinger/Øving 5/Frontend/vue-oving-mpa/src/components/Login.vue"],"sourcesContent":["<script setup>\r\nimport { ref } from 'vue';\r\nimport { useRouter } from 'vue-router';\r\nimport { authState } from '@/eventBus'; // Ensure correct path to eventBus.js\r\n\r\nconst username = ref('');\r\nconst password = ref('');\r\nconst router = useRouter();\r\n\r\nconst login = async () => {\r\n  try {\r\n    const response = await fetch('http://localhost:8088/api/calculator/login', {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/x-www-form-urlencoded' },\r\n      body: new URLSearchParams({ username: username.value, password: password.value }),\r\n    });\r\n\r\n    if (response.ok) {\r\n      const token = await response.text();\r\n      console.log('Received token:', token); // Log the token\r\n      if (!token || !token.includes('.')) {\r\n        console.error('Token is not a valid JWT:', token);\r\n      }\r\n      sessionStorage.setItem('jwtToken', token);\r\n      authState.isLoggedIn = true; // Set authState\r\n      router.push('/calculator');\r\n    } else {\r\n      console.log('Login failed with status:', response.status, 'Response:', await response.text());\r\n      alert('Login failed');\r\n    }\r\n  } catch (error) {\r\n    console.error('Login error:', error);\r\n    alert('An error occurred during login');\r\n  }\r\n};\r\n</script>\r\n\r\n<template>\r\n  <div>\r\n    <input v-model=\"username\" placeholder=\"Username\" />\r\n    <input v-model=\"password\" type=\"password\" placeholder=\"Password\" />\r\n    <button @click=\"login\">Login</button>\r\n  </div>\r\n</template>\r\n"],"mappings":";;;;AACA,SAASA,GAAG,QAAQ,KAAK;AACzB,SAASC,SAAS,QAAQ,YAAY;AACtC,SAASC,SAAS,QAAQ,YAAY,CAAC,CAAC;;;;;;;;IAExC,MAAMC,QAAQ,GAAGH,GAAG,CAAC,EAAE,CAAC;IACxB,MAAMI,QAAQ,GAAGJ,GAAG,CAAC,EAAE,CAAC;IACxB,MAAMK,MAAM,GAAGJ,SAAS,CAAC,CAAC;IAE1B,MAAMK,KAAK,GAAG,MAAAA,CAAA,KAAY;MACxB,IAAI;QACF,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CAAC,4CAA4C,EAAE;UACzEC,MAAM,EAAE,MAAM;UACdC,OAAO,EAAE;YAAE,cAAc,EAAE;UAAoC,CAAC;UAChEC,IAAI,EAAE,IAAIC,eAAe,CAAC;YAAET,QAAQ,EAAEA,QAAQ,CAACU,KAAK;YAAET,QAAQ,EAAEA,QAAQ,CAACS;UAAM,CAAC;QAClF,CAAC,CAAC;QAEF,IAAIN,QAAQ,CAACO,EAAE,EAAE;UACf,MAAMC,KAAK,GAAG,MAAMR,QAAQ,CAACS,IAAI,CAAC,CAAC;UACnCC,OAAO,CAACC,GAAG,CAAC,iBAAiB,EAAEH,KAAK,CAAC,CAAC,CAAC;UACvC,IAAI,CAACA,KAAK,IAAI,CAACA,KAAK,CAACI,QAAQ,CAAC,GAAG,CAAC,EAAE;YAClCF,OAAO,CAACG,KAAK,CAAC,2BAA2B,EAAEL,KAAK,CAAC;UACnD;UACAM,cAAc,CAACC,OAAO,CAAC,UAAU,EAAEP,KAAK,CAAC;UACzCb,SAAS,CAACqB,UAAU,GAAG,IAAI,CAAC,CAAC;UAC7BlB,MAAM,CAACmB,IAAI,CAAC,aAAa,CAAC;QAC5B,CAAC,MAAM;UACLP,OAAO,CAACC,GAAG,CAAC,2BAA2B,EAAEX,QAAQ,CAACkB,MAAM,EAAE,WAAW,EAAE,MAAMlB,QAAQ,CAACS,IAAI,CAAC,CAAC,CAAC;UAC7FU,KAAK,CAAC,cAAc,CAAC;QACvB;MACF,CAAC,CAAC,OAAON,KAAK,EAAE;QACdH,OAAO,CAACG,KAAK,CAAC,cAAc,EAAEA,KAAK,CAAC;QACpCM,KAAK,CAAC,gCAAgC,CAAC;MACzC;IACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}